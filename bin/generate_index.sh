#!/bin/bash
# -----------------------------------------------------------------------------
# GOVERNANCE & DISCIPLINE
#
# This script is governed by:
#   - docs/03_Technical/QT-Coding-SOP.md
#   - MASTER_INDEX.md
#
# Logic: Automated Librarian for Quantum Trek Data Room
# -----------------------------------------------------------------------------

INDEX_FILE="MASTER_INDEX.md"
ET_TIME=$(TZ="America/New_York" date "+%Y-%m-%d %H:%M:%S ET")

echo "# ðŸš€ Quantum Trek Master Index" > $INDEX_FILE
echo "### Last Updated: $ET_TIME" >> $INDEX_FILE
echo "---" >> $INDEX_FILE
echo "This index serves as the official directory for the Quantum Trek Private Placement Memorandum (PPM) and Technical Data Room." >> $INDEX_FILE
echo "" >> $INDEX_FILE
echo "## ðŸ›¡ï¸ Security & Access" >> $INDEX_FILE
echo "* [Security Policy](./SECURITY.md) - IP Protection & Access Protocols" >> $INDEX_FILE
echo "" >> $INDEX_FILE

# Standard Data Room Dirs
DIRS=("01_Legal" "02_Finance" "03_Technical" "04_Defense")

for dir in "${DIRS[@]}"; do
    echo "## ${dir//_/ }" >> $INDEX_FILE
    if [ -d "docs/$dir" ] && [ "$(ls -A docs/$dir)" ]; then
        for file in docs/$dir/*; do
            filename=$(basename "$file")
            echo "* [$filename](./docs/$dir/$filename)" >> $INDEX_FILE
        done
    else
        echo "* *No documents uploaded yet.*" >> $INDEX_FILE
    fi
    echo "" >> $INDEX_FILE
done

echo "---" >> $INDEX_FILE
echo "Generated by qtlog v1.3.0 Unified CLI" >> $INDEX_FILE
